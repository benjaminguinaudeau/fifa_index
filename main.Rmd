---
title: "main"
author: "Benjamin"
date: '2019-05-21'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(furrr)

```

```{r}
pacman::p_load(tidyverse, furrr, fifaindex)
plan(multiprocess, workers = 2)

player <- get_player_stats(player_id = 214977, year = 2019) %>%
  glimpse
player <- get_player_stats(player_id = 229659, year = 2019) %>%
  glimpse
player_16 <- get_player_stats(player_id = 229659) %>%
  glimpse

player_16 %>%
  unnest(data)

ids <- fifaindex::ids
sample <- ids %>%
  sample(10)

sample_stats_1 <- sample %>%
  .[1] %>%
  map(get_player_stats)
  #future_map(get_player_stats, .progress = T)

sample_stats_1  %>%
  reduce(bind_rows) %>%
  unnest(data)

sample_stats <- sample %>%
  .[1] %>%
  #map(get_player_stats)
  future_map(get_player_stats, .progress = T)  
  
sample_stats  %>%
  reduce(bind_rows) %>%
  unnest(data)

```

